(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-push-circle"],{"1d333":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"page",attrs:{id:"moments"}},[i("v-uni-view",{staticClass:"home-pic"},[i("avatar",{attrs:{selWidth:"600upx",selHeight:"600upx",avatarSrc:t.circleImg,avatarStyle:"width: 750upx; height: 500upx; border-radius: 0upx;"},on:{upload:function(e){e=t.$handleEvent(e),t.upload(e)}}}),i("v-uni-view",{staticClass:"home-pic-base"},[i("v-uni-view",{staticClass:"top-pic"},[i("v-uni-image",{staticClass:"header",attrs:{src:t.myPhoto,"lazy-load":!0},on:{click:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.goDetails(t.my_data.id)}}})],1),i("v-uni-view",{staticClass:"top-name"},[t._v(t._s(t.my_data.nickname))])],1)],1),t.no_reader_msg?i("v-uni-view",{staticClass:"new_msg",on:{click:function(e){e=t.$handleEvent(e),t.goCircleChat(e)}}},[t._v("你有新的消息")]):t._e(),t._l(t.posts,function(e,n){return i("v-uni-view",{key:n,staticClass:"moments__post",attrs:{id:"post-"+n}},[i("v-uni-view",{staticClass:"post-left"},[i("v-uni-image",{staticClass:"post_header",attrs:{src:t.staticPhoto+e.header_image+"?_="+t.imgRan,"lazy-load":!0},on:{click:function(i){i=t.$handleEvent(i),t.goDetails(e.uid)}}})],1),i("v-uni-view",{staticClass:"post_right"},[i("v-uni-text",{staticClass:"post-username",on:{click:function(i){i=t.$handleEvent(i),t.goDetails(e.uid)}}},[t._v(t._s(e.username))]),i("v-uni-view",{staticClass:"paragraph",attrs:{id:"paragraph"},on:{click:function(e){e=t.$handleEvent(e),t.init_input()}}},[t._v(t._s(e.content.text))]),0==e.type?i("v-uni-view",{staticClass:"thumbnails",on:{click:function(e){e=t.$handleEvent(e),t.init_input()}}},t._l(e.content.value,function(a,o){return i("v-uni-view",{key:o,class:1===e.content.value.length?"my-gallery":"thumbnail"},[i("v-uni-image",{staticClass:"gallery_img",attrs:{"lazy-load":!0,mode:"aspectFill",src:t.staticPath+e.post_id+"/"+a,"data-src":a},on:{click:function(e){e=t.$handleEvent(e),t.previewImage(n,o)}}})],1)}),1):t._e(),i("v-uni-view",{staticClass:"toolbar"},[i("v-uni-view",{staticClass:"timestamp"},[t._v(t._s(e.timestamp))]),i("v-uni-view",{staticClass:"like",on:{click:function(e){e=t.$handleEvent(e),t.like(n)}}},[i("v-uni-image",{attrs:{src:0===e.islike?"../../static/theme/default/push/circle/islike.png":"../../static/theme/default/push/circle/like.png","lazy-load":!0}})],1),i("v-uni-view",{staticClass:"comment",on:{click:function(e){e=t.$handleEvent(e),t.comment(n)}}},[i("v-uni-image",{attrs:{src:"../../static/theme/default/push/circle/comment.png","lazy-load":!0}})],1)],1),i("v-uni-view",{staticClass:"post-footer"},[e.like.length?i("v-uni-view",{staticClass:"footer_content"},[i("v-uni-image",{staticClass:"liked",attrs:{src:"../../static/theme/default/push/circle/liked.png","lazy-load":!0}}),t._l(e.like,function(e,n){return i("v-uni-text",{key:n,staticClass:"nickname",on:{click:function(i){i=t.$handleEvent(i),t.goDetails(e.uid)}}},[t._v(t._s((n?",":"")+e.username))])})],2):t._e(),t._l(e.comments,function(e,a){return i("v-uni-view",{key:a,staticClass:"footer_content",on:{click:function(e){e=t.$handleEvent(e),t.reply(n,a)}}},[i("v-uni-text",{staticClass:"comment-nickname",staticStyle:{"word-break":"break-all"}},[t._v(t._s(e.username+e.reply+": ")),i("v-uni-text",{staticClass:"comment-content"},[t._v(t._s(e.content))])],1)],1)})],2)],1)],1)}),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.showInput,expression:"showInput"}],staticClass:"foot"},[i("chat-input",{attrs:{focus:t.focus,placeholder:t.input_placeholder},on:{"send-message":function(e){e=t.$handleEvent(e),t.send_comment(e)},blur:function(e){e=t.$handleEvent(e),t.blur(e)}}})],1),t.showLoadMore?i("v-uni-view",{staticClass:"uni-loadmore"},[t._v(t._s(t.loadMoreText))]):t._e()],2)},a=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return a})},"4e89":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".footer[data-v-2287443c]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;width:100%;height:%?80?%;min-height:%?80?%;border-top:solid 1px #bbb;overflow:hidden;padding:%?5?%;background-color:#f4f5f6}.footer-left[data-v-2287443c]{width:%?80?%;height:%?80?%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.footer-right[data-v-2287443c]{width:%?120?%;height:%?80?%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;color:#1482d1}.footer-center[data-v-2287443c]{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;padding-left:%?20?%;height:%?80?%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.footer-center .input-text[data-v-2287443c]{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;background:#fff;\n\t/* border: solid 1upx #ddd; */padding:%?10?%!important;font-family:verdana!important;overflow:hidden;border-radius:%?15?%}.footer-right .send-comment[data-v-2287443c]{background-color:#007aff;text-align:center;line-height:%?60?%;color:#fff;width:%?80?%;height:%?60?%;border-radius:5px;font-size:10px\n\t/* height: 60upx; */}",""])},"6ea7":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"footer"},[i("v-uni-view",{staticClass:"footer-center"},[i("v-uni-textarea",{staticClass:"input-text",staticStyle:{"max-height":"65upx"},attrs:{"auto-height":"true",focus:t.focus,placeholder:t.placeholder,maxlength:-1,"show-confirm-bar":!1},on:{confirm:function(e){e=t.$handleEvent(e),t.sendMessge(e)},blur:function(e){e=t.$handleEvent(e),t.blur(e)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}})],1),i("v-uni-view",{staticClass:"footer-right"},[i("v-uni-view",{staticClass:"send-comment",attrs:{id:"msg-type"},on:{click:function(e){e=t.$handleEvent(e),t.sendMessge(e)}}},[t._v("发送")])],1)],1)},a=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return a})},"75fce":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={data:function(){return{inputValue:""}},props:{placeholder:{type:String,required:!0},focus:{type:Boolean,required:!0}},onLoad:function(){},methods:{blur:function(){this.$emit("blur")},startRecognize:function(){var t={},e=this;t.engine="iFly",e.inputValue="",plus.speech.startRecognize(t,function(t){console.log(t),e.inputValue+=t},function(t){console.log("语音识别失败："+t.message)})},sendMessge:function(){this.inputValue?(this.$emit("send-message",this.inputValue),this.inputValue=""):uni.showModal({content:"还没有输入内容哦!",showCancel:!1})}}};e.default=n},7908:function(t,e,i){var n=i("8f9f");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("375453de",n,!0,{sourceMap:!1,shadowMode:!1})},"88b7":function(t,e,i){"use strict";var n=i("9a91"),a=i.n(n);a.a},"8f9f":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".liked[data-v-cd22efd8]{\r\n\t/* display: inline-block; */position:relative;margin-right:%?10?%;width:%?34?%;height:%?34?%}.post-username[data-v-cd22efd8]{font-size:%?32?%;font-weight:600;color:#36648b}.gallery_img[data-v-cd22efd8]{width:100%;height:100%}.header[data-v-cd22efd8]{width:%?250?%;height:%?250?%;z-index:10;border-radius:%?40?%}.publish[data-v-cd22efd8]{position:absolute;top:%?20?%;right:%?20?%\r\n\r\n\t/* z-index: 9999; */}.post_header[data-v-cd22efd8]{width:%?85?%!important;height:%?85?%!important;border-radius:%?10?%;margin-top:%?8?%}#moments[data-v-cd22efd8]{background:#fff}#moments .home-pic[data-v-cd22efd8]{width:100%;\r\n\t/* margin-top: -150upx; */position:relative;height:%?500?%;z-index:5;margin-bottom:%?50?%}#moments .home-pic-base[data-v-cd22efd8]{position:absolute;left:%?-60?%;bottom:%?-70?%;width:100%;height:%?160?%;padding:0 %?15?%}#moments .home-pic-base .top-pic[data-v-cd22efd8]{width:%?250?%;height:%?250?%;border-radius:%?40?%;-webkit-transform:scale(.5);-ms-transform:scale(.5);transform:scale(.5);-webkit-transform-origin:100% 0;-ms-transform-origin:100% 0;transform-origin:100% 0;background-color:#fff;float:right}#moments .home-pic-base .top-name[data-v-cd22efd8]{position:absolute;\r\n\t/* left: 20px; */right:%?160?%;top:%?45?%;font-size:%?32?%;font-weight:600;text-align:right;color:#fff;overflow:hidden}#moments .moments__post[data-v-cd22efd8]{background:#fff;display:block;border-bottom:1px solid #f2eeee;padding:%?30?% %?20?%;position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}#moments .moments__post[data-v-cd22efd8]:before{content:none}#moments .moments__post .post_right[data-v-cd22efd8]{font-size:%?32?%;display:table-cell;padding-left:%?20?%;width:100%}\r\n/* #moments .moments__post .post_right .paragraphExtender {\r\n\t\tmargin: 5px auto;\r\n\t\tdisplay: -webkit-box;\r\n\t\tdisplay: -webkit-flex;\r\n\t\tdisplay: -ms-flexbox;\r\n\t\tdisplay: flex\r\n\t} */#moments .moments__post .title[data-v-cd22efd8]{color:#094dcc}#moments .moments__post .thumbnails[data-v-cd22efd8]{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap\r\n\t/* display: -webkit-box;\r\n\tdisplay: -webkit-flex;\r\n\tdisplay: -ms-flexbox; */\r\n\t/* -webkit-flex-wrap: wrap;\r\n\t-ms-flex-wrap: wrap; */}#moments .moments__post .thumbnails .thumbnail[data-v-cd22efd8]{width:30%;height:%?180?%;margin:%?4?%;background:#757575;overflow:hidden}.my-gallery[data-v-cd22efd8]{width:%?250?%;height:%?400?%;margin:%?4?%;background:#757575;overflow:hidden}#moments .moments__post .toolbar[data-v-cd22efd8]{position:relative;top:%?10?%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}#moments .moments__post .toolbar .timestamp[data-v-cd22efd8]{color:#757575;font-size:%?22?%}#moments .moments__post .like[data-v-cd22efd8]{width:auto;height:auto;position:absolute;right:%?70?%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}#moments .moments__post .comment[data-v-cd22efd8]{width:auto;height:auto;position:absolute;right:%?10?%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}#moments .moments__post .toolbar uni-image[data-v-cd22efd8]{padding-left:%?20?%;width:%?30?%;height:%?30?%}.post-footer[data-v-cd22efd8]{margin-top:%?30?%;background-color:#f3f3f5;width:100%}#moments .moments__post .footer_content[data-v-cd22efd8]{padding-left:%?10?%;position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}#moments .moments__post .footer_content .nickname[data-v-cd22efd8]{color:#36648b;font-size:%?24?%}#moments .moments__post .footer_content .comment-nickname[data-v-cd22efd8]{color:#36648b;font-size:%?24?%}#moments .moments__post .footer_content .comment-content[data-v-cd22efd8]{color:#000;font-size:%?24?%}.foot[data-v-cd22efd8]{position:fixed;width:100%;height:%?90?%;min-height:%?90?%;left:%?0?%;bottom:%?0?%;overflow:hidden}.new_msg[data-v-cd22efd8]{text-align:center;color:#36648b;font-weight:700}",""])},"92de":function(t,e,i){"use strict";var n=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("a481");var a=n(i("bd86")),o=n(i("b613")),s=n(i("164f")),l=n(i("ae82")),r=n(i("0497")),c=n(i("ca63")),d={components:{chatInput:o.default,avatar:r.default},data:function(){var t;return{my_data:(t={id:0,photo:"",nickname:""},(0,a.default)(t,"photo","default_man/90.jpg"),(0,a.default)(t,"circle_img","default_circle_img.jpg"),t),user_id:0,posts:[],index:"",comment_index:"",input_placeholder:"评论",focus:!1,is_reply:!1,showInput:!1,screenHeight:"",platform:"",windowHeight:"",loadMoreText:"加载中...",showLoadMore:!1,is_more:!1,no_reader_msg:0,like_status:!1}},computed:{myPhoto:function(){return c.default.staticPhoto()+this.my_data.photo+"?_="+this.imgRan},circleImg:function(){return c.default.staticPhoto()+this.my_data.circle_img},staticPath:function(){return c.default.staticCircle()},staticPhoto:function(){return c.default.staticPhoto()},imgRan:function(){return Math.random()}},onLoad:function(t){var e=this;uni.getSystemInfo({success:function(t){e.screenHeight=t.screenHeight,e.platform=t.platform}})},onShow:function(){var t=this;l.default.routeSonHook();var e=this,i=c.default.localData("circle_data");i?(e.posts=i,(c.default.data("no_reader_circle")||c.default.data("no_reader_circle_chat_num"))&&(this.posts=[],c.default.data("circle_data",[]),this.pullDownRefresh())):e.pullDownRefresh(),this.no_reader_msg=c.default.data("no_reader_circle_chat_num")?1:0,c.default.data("no_reader_circle",0),uni.onWindowResize(function(e){"ios"===t.platform?(t.windowHeight=e.size.windowHeight,t.adjust()):t.screenHeight-e.size.windowHeight>60&&t.windowHeight<=e.size.windowHeight&&(t.windowHeight=e.size.windowHeight,t.adjust())}),uni.$on("data_circle_data",function(t){e.posts=t}),uni.$on("data_user_info",function(t){e.my_data=t}),uni.$on("data_circle_tips",function(t){isNaN(t)||(e.no_reader_msg=1)}),e.my_data=c.default.data("user_info")},onUnload:function(){uni.$off("data_circle_tips"),uni.$off("data_user_info"),uni.$off("data_circle_data"),uni.offWindowResize(),this.max=0,this.data=[],this.loadMoreText="加载更多",this.showLoadMore=!1},onReachBottom:function(){var t=this,e=this;if(e.showLoadMore=!0,!e.is_more){var i=0,n=e.posts.length;n&&(i=e.posts[n-1].time),s.default.getCircleList({time:i,type:1,user_id:0},function(i){e.my_data=i.user_info,i.data.length<10&&(t.loadMoreText="没有更多数据了",t.is_more=!0)})}},onPullDownRefresh:function(){(c.default.data("no_reader_circle")||c.default.data("no_reader_circle_chat_num"))&&(this.posts=[],c.default.data("circle_data",[])),this.pullDownRefresh()},onNavigationBarButtonTap:function(t){0==t.index&&this.navigateTo("./circle/send")},methods:{upload:function(t){var e=this;e.$httpSendFile({local_url:t.path,type:3,success:function(t){e.$httpSend({path:"/im/action/upCircleImg",success:function(t){s.default.base(),uni.showToast({title:"更换成功",duration:2e3})}})}})},goCircleChat:function(){c.default.data("no_reader_circle_chat_num",0),this.navigateTo("./circle_chat_details")},pullDownRefresh:function(){var t=this,e=0;this.posts.length&&(e=this.posts[0].time),s.default.getCircleList({time:e,type:0,user_id:0},function(e){t.my_data=e.user_info}),uni.stopPullDownRefresh(),c.default.data("no_reader_circle",0)},goDetails:function(t){this.navigateTo("../details/index?user_id="+t)},navigateTo:function(t){uni.navigateTo({url:t})},like:function(t){var e=this;this.like_status||(this.like_status=!0,e.$httpSend({path:"/im/circle/likeAction",data:{id:e.posts[t].post_id},success:function(i){if(e.posts[t].islike=i.action,i.action)e.posts[t].like.push({uid:e.my_data.id,username:e.my_data.nickname});else for(var n=0,a=e.posts[t].like.length;n<a;n++)if(e.posts[t].like[n].uid==e.my_data.id){e.posts[t].like.splice(n,1),c.default.data("circle_data",e.posts);break}e.like_status=!1}}))},comment:function(t){this.showInput?(this.showInput=!1,this.focus=!1,this.index=""):(this.showInput=!0,this.focus=!0,this.index=t)},adjust:function(){var t=this;uni.createSelectorQuery().selectViewport().scrollOffset(function(e){var i=e.scrollTop,n=uni.createSelectorQuery().select("#post-"+t.index);n.boundingClientRect(function(e){uni.pageScrollTo({scrollTop:i-(t.windowHeight-(e.height+e.top+45)),duration:300})}).exec()}).exec()},reply:function(t,e){this.is_reply=!0,this.showInput=!0;var i=this.posts[t].comments[e].username;this.input_placeholder="回复"+i,this.index=t,this.comment_index=e,this.focus=!0},blur:function(){},send_comment:function(t){var e=this,i=this.posts[this.index],n=i.uid,a="";if(this.is_reply){var o=i.comments[this.comment_index];n=o.uid,i.uid!=n&&(a="回复"+o.username)}e.$httpSend({path:"/im/circle/comment",data:{message:t,id:i.post_id,chat_user_id:n},success:function(n){i.comments.push({uid:e.my_data.id,reply:a,username:e.my_data.nickname,content:t}),e.init_input()}})},init_input:function(){this.showInput=!1,this.focus=!1,this.input_placeholder="评论",this.is_reply=!1},previewImage:function(t,e){for(var i=this.posts[t],n=[],a=0,o=i.content.value.length;a<o;a++)n.push(this.staticPath+i.post_id+"/"+i.content.value[a].replace("_thumb",""));var s=n[e];uni.previewImage({current:s,urls:n})},goPublish:function(){uni.navigateTo({url:"./circle/send",success:function(t){},fail:function(){},complete:function(){}})}},watch:{}};e.default=d},9934:function(t,e,i){"use strict";var n=i("7908"),a=i.n(n);a.a},"9a91":function(t,e,i){var n=i("4e89");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("a0ab5bd2",n,!0,{sourceMap:!1,shadowMode:!1})},a7a1:function(t,e,i){"use strict";i.r(e);var n=i("1d333"),a=i("c460");for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);i("9934");var s=i("2877"),l=Object(s["a"])(a["default"],n["a"],n["b"],!1,null,"cd22efd8",null);e["default"]=l.exports},b613:function(t,e,i){"use strict";i.r(e);var n=i("6ea7"),a=i("b841");for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);i("88b7");var s=i("2877"),l=Object(s["a"])(a["default"],n["a"],n["b"],!1,null,"2287443c",null);e["default"]=l.exports},b841:function(t,e,i){"use strict";i.r(e);var n=i("75fce"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);e["default"]=a.a},c460:function(t,e,i){"use strict";i.r(e);var n=i("92de"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);e["default"]=a.a}}]);